{"version":3,"sources":["pnotify.desktop.js"],"names":["root","factory","define","amd","exports","module","require","jQuery","PNotify","window","$","permission","notify","title","options","Notification","navigator","mozNotification","createNotification","body","icon","show","webkitNotifications","prototype","desktop","fallback","tag","text","modules","genNotice","notice","type","Math","round","random","close","cancel","onclick","elem","trigger","onclose","state","remove","init","checkPermission","auto_display","update","oldOpts","beforeOpen","css","removeClass","afterOpen","beforeClose","afterClose","requestPermission"],"mappings":"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","file":"src/pnotify.desktop.js","sourceRoot":"../","sourcesContent":["// Desktop\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as a module.\n    define('pnotify.desktop', ['jquery', 'pnotify'], factory);\n  } else if (typeof exports === 'object' && typeof module !== 'undefined') {\n    // CommonJS\n    module.exports = factory(require('jquery'), require('./pnotify'));\n  } else {\n    // Browser globals\n    factory(root.jQuery, root.PNotify);\n  }\n}(typeof window !== \"undefined\" ? window : this, function($, PNotify){\n  var permission;\n  var notify = function(title, options){\n    // Memoize based on feature detection.\n    if (\"Notification\" in window) {\n      notify = function (title, options) {\n        return new Notification(title, options);\n      };\n    } else if (\"mozNotification\" in navigator) {\n      notify = function (title, options) {\n        // Gecko < 22\n        return navigator.mozNotification\n          .createNotification(title, options.body, options.icon)\n          .show();\n      };\n    } else if (\"webkitNotifications\" in window) {\n      notify = function (title, options) {\n        return window.webkitNotifications.createNotification(\n          options.icon,\n          title,\n          options.body\n        );\n      };\n    } else {\n      notify = function (title, options) {\n        return null;\n      };\n    }\n    return notify(title, options);\n  };\n\n\n  PNotify.prototype.options.desktop = {\n    // Display the notification as a desktop notification.\n    desktop: false,\n    // If desktop notifications are not supported or allowed, fall back to a regular notice.\n    fallback: true,\n    // The URL of the icon to display. If false, no icon will show. If null, a default icon will show.\n    icon: null,\n    // Using a tag lets you update an existing notice, or keep from duplicating notices between tabs.\n    // If you leave tag null, one will be generated, facilitating the \"update\" function.\n    // see: http://www.w3.org/TR/notifications/#tags-example\n    tag: null,\n    // Optionally display a different title for the desktop.\n    title: null,\n    // Optionally display different text for the desktop.\n    text: null\n  };\n  PNotify.prototype.modules.desktop = {\n    genNotice: function(notice, options){\n      if (options.icon === null) {\n        this.icon = \"http://sciactive.com/pnotify/includes/desktop/\"+notice.options.type+\".png\";\n      } else if (options.icon === false) {\n        this.icon = null;\n      } else {\n        this.icon = options.icon;\n      }\n      if (this.tag === null || options.tag !== null) {\n        this.tag = options.tag === null ? \"PNotify-\"+Math.round(Math.random() * 1000000) : options.tag;\n      }\n      notice.desktop = notify(options.title || notice.options.title, {\n        icon: this.icon,\n        body: options.text || notice.options.text,\n        tag: this.tag\n      });\n      if (!(\"close\" in notice.desktop) && (\"cancel\" in notice.desktop)) {\n        notice.desktop.close = function(){\n          notice.desktop.cancel();\n        };\n      }\n      notice.desktop.onclick = function(){\n        notice.elem.trigger(\"click\");\n      };\n      notice.desktop.onclose = function(){\n        if (notice.state !== \"closing\" && notice.state !== \"closed\") {\n          notice.remove();\n        }\n      };\n    },\n    init: function(notice, options){\n      if (!options.desktop)\n        return;\n      permission = PNotify.desktop.checkPermission();\n      if (permission !== 0) {\n        // Keep the notice from opening if fallback is false.\n        if (!options.fallback) {\n          notice.options.auto_display = false;\n        }\n        return;\n      }\n      this.genNotice(notice, options);\n    },\n    update: function(notice, options, oldOpts){\n      if ((permission !== 0 && options.fallback) || !options.desktop)\n        return;\n      this.genNotice(notice, options);\n    },\n    beforeOpen: function(notice, options){\n      if ((permission !== 0 && options.fallback) || !options.desktop)\n        return;\n      notice.elem.css({'left': '-10000px'}).removeClass('ui-pnotify-in');\n    },\n    afterOpen: function(notice, options){\n      if ((permission !== 0 && options.fallback) || !options.desktop)\n        return;\n      notice.elem.css({'left': '-10000px'}).removeClass('ui-pnotify-in');\n      if (\"show\" in notice.desktop) {\n        notice.desktop.show();\n      }\n    },\n    beforeClose: function(notice, options){\n      if ((permission !== 0 && options.fallback) || !options.desktop)\n        return;\n      notice.elem.css({'left': '-10000px'}).removeClass('ui-pnotify-in');\n    },\n    afterClose: function(notice, options){\n      if ((permission !== 0 && options.fallback) || !options.desktop)\n        return;\n      notice.elem.css({'left': '-10000px'}).removeClass('ui-pnotify-in');\n      if (\"close\" in notice.desktop) {\n        notice.desktop.close();\n      }\n    }\n  };\n  PNotify.desktop = {\n    permission: function(){\n      if (typeof Notification !== \"undefined\" && \"requestPermission\" in Notification) {\n        Notification.requestPermission();\n      } else if (\"webkitNotifications\" in window) {\n        window.webkitNotifications.requestPermission();\n      }\n    },\n    checkPermission: function(){\n      if (typeof Notification !== \"undefined\" && \"permission\" in Notification) {\n        return (Notification.permission === \"granted\" ? 0 : 1);\n      } else if (\"webkitNotifications\" in window) {\n        return window.webkitNotifications.checkPermission() == 0 ? 0 : 1;\n      } else {\n        return 1;\n      }\n    }\n  };\n  permission = PNotify.desktop.checkPermission();\n  return PNotify;\n}));\n"]}