{"version":3,"sources":["pnotify.history.js"],"names":["root","factory","define","amd","exports","module","require","jQuery","PNotify","window","$","history_menu","history_handle_top","on","each","notices","modules","history","inHistory","elem","is","options","hide","queueRemove","open","pushTop","prototype","stack","push","i","notice","slice","menu","fixed","maxonscreen","Infinity","labels","redisplay","all","last","init","destroy","styles","hi_menu","css","append","hi_btn","addClass","hi_btnhov","removeClass","trigger","appendTo","handle","hi_hnd","offset","top","update","beforeOpen","length","el","remove","extend","styling","brighttheme","bootstrap3","fontawesome"],"mappings":"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","file":"src/pnotify.history.js","sourceRoot":"../","sourcesContent":["// History\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as a module.\n    define('pnotify.history', ['jquery', 'pnotify'], factory);\n  } else if (typeof exports === 'object' && typeof module !== 'undefined') {\n    // CommonJS\n    module.exports = factory(require('jquery'), require('./pnotify'));\n  } else {\n    // Browser globals\n    factory(root.jQuery, root.PNotify);\n  }\n}(typeof window !== \"undefined\" ? window : this, function($, PNotify){\n  var history_menu,\n      history_handle_top;\n  $(function(){\n    $(\"body\").on(\"pnotify.history-all\", function(){\n      // Display all notices. (Disregarding non-history notices.)\n      $.each(PNotify.notices, function(){\n        if (this.modules.history.inHistory) {\n          if (this.elem.is(\":visible\")) {\n            // The hide variable controls whether the history pull down should\n            // queue a removal timer.\n            if (this.options.hide)\n              this.queueRemove();\n          } else if (this.open)\n            this.open();\n        }\n      });\n    }).on(\"pnotify.history-last\", function(){\n      var pushTop = (PNotify.prototype.options.stack.push === \"top\");\n\n      // Look up the last history notice, and display it.\n      var i = (pushTop ? 0 : -1);\n\n      var notice;\n      do {\n        if (i === -1)\n          notice = PNotify.notices.slice(i);\n        else\n          notice = PNotify.notices.slice(i, i+1);\n        if (!notice[0])\n          return false;\n\n        i = (pushTop ? i + 1 : i - 1);\n      } while (!notice[0].modules.history.inHistory || notice[0].elem.is(\":visible\"));\n      if (notice[0].open)\n        notice[0].open();\n    });\n  });\n  PNotify.prototype.options.history = {\n    // Place the notice in the history.\n    history: true,\n    // Display a pull down menu to redisplay previous notices.\n    menu: false,\n    // Make the pull down menu fixed to the top of the viewport.\n    fixed: true,\n    // Maximum number of notifications to have onscreen.\n    maxonscreen: Infinity,\n    // The various displayed text, helps facilitating internationalization.\n    labels: {\n      redisplay: \"Redisplay\",\n      all: \"All\",\n      last: \"Last\"\n    }\n  };\n  PNotify.prototype.modules.history = {\n    init: function(notice, options){\n      // Make sure that no notices get destroyed.\n      notice.options.destroy = false;\n\n      // The history variable controls whether the notice gets redisplayed\n      // by the history pull down.\n      this.inHistory = options.history;\n\n      if (options.menu) {\n        // If there isn't a history pull down, create one.\n        if (typeof history_menu === \"undefined\") {\n          history_menu = $(\"<div />\", {\n            \"class\": \"ui-pnotify-history-container \"+notice.styles.hi_menu,\n            \"mouseleave\": function(){\n              history_menu.css(\"top\", \"-\"+history_handle_top+\"px\");\n            }\n          })\n          .append($(\"<div />\", {\"class\": \"ui-pnotify-history-header\", \"text\": options.labels.redisplay}))\n          .append($(\"<button />\", {\n            \"class\": \"ui-pnotify-history-all \"+notice.styles.hi_btn,\n            \"text\": options.labels.all,\n            \"mouseenter\": function(){\n              $(this).addClass(notice.styles.hi_btnhov);\n            },\n            \"mouseleave\": function(){\n              $(this).removeClass(notice.styles.hi_btnhov);\n            },\n            \"click\": function(){\n              $(this).trigger(\"pnotify.history-all\");\n              return false;\n            }\n          }))\n          .append($(\"<button />\", {\n            \"class\": \"ui-pnotify-history-last \"+notice.styles.hi_btn,\n            \"text\": options.labels.last,\n            \"mouseenter\": function(){\n              $(this).addClass(notice.styles.hi_btnhov);\n            },\n            \"mouseleave\": function(){\n              $(this).removeClass(notice.styles.hi_btnhov);\n            },\n            \"click\": function(){\n              $(this).trigger(\"pnotify.history-last\");\n              return false;\n            }\n          }))\n          .appendTo(\"body\");\n\n          // Make a handle so the user can pull down the history tab.\n          var handle = $(\"<span />\", {\n            \"class\": \"ui-pnotify-history-pulldown \"+notice.styles.hi_hnd,\n            \"mouseenter\": function(){\n              history_menu.css(\"top\", \"0\");\n            }\n          })\n          .appendTo(history_menu);\n\n          // Get the top of the handle.\n          history_handle_top = handle.offset().top + 2;\n          // Hide the history pull down up to the top of the handle.\n          history_menu.css(\"top\", \"-\"+history_handle_top+\"px\");\n\n          // Apply the fixed styling.\n          if (options.fixed) {\n            history_menu.addClass('ui-pnotify-history-fixed');\n          }\n        }\n      }\n    },\n    update: function(notice, options){\n      // Update values for history menu access.\n      this.inHistory = options.history;\n      if (options.fixed && history_menu) {\n        history_menu.addClass('ui-pnotify-history-fixed');\n      } else if (history_menu) {\n        history_menu.removeClass('ui-pnotify-history-fixed');\n      }\n    },\n    beforeOpen: function(notice, options){\n      // Remove oldest notifications leaving only options.maxonscreen on screen\n      if (PNotify.notices && (PNotify.notices.length > options.maxonscreen)) {\n        // Oldest are normally in front of array, or if stack.push==\"top\" then\n        // they are at the end of the array! (issue #98)\n        var el;\n        if (notice.options.stack.push !== \"top\") {\n          el = PNotify.notices.slice(0, PNotify.notices.length - options.maxonscreen);\n        } else {\n          el = PNotify.notices.slice(options.maxonscreen, PNotify.notices.length);\n        }\n\n        $.each(el, function(){\n          if (this.remove) {\n            this.remove();\n          }\n        });\n      }\n    }\n  };\n  $.extend(PNotify.styling.brighttheme, {\n    hi_menu: \"ui-pnotify-history-brighttheme\",\n    hi_btn: \"\",\n    hi_btnhov: \"\",\n    hi_hnd: \"\"\n  });\n  $.extend(PNotify.styling.bootstrap3, {\n    hi_menu: \"well\",\n    hi_btn: \"btn btn-default\",\n    hi_btnhov: \"\",\n    hi_hnd: \"glyphicon glyphicon-chevron-down\"\n  });\n  $.extend(PNotify.styling.fontawesome, {\n    hi_menu: \"well\",\n    hi_btn: \"btn btn-default\",\n    hi_btnhov: \"\",\n    hi_hnd: \"fa fa-chevron-down\"\n  });\n  return PNotify;\n}));\n"]}